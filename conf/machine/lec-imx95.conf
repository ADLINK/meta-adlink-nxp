#machine configuration file for LEC-IMX8MP

MACHINEOVERRIDES =. "mx95:"

require conf/machine/include/imx95-evk.inc

# kernel
IMX_KERNEL_CONFIG_AARCH64:lec-imx95 = "lec-imx95_defconfig"

# The device tree name is implicit for LPDDR4, so can't use MACHINE here
KERNEL_DEVICETREE_BASENAME = "lec-imx95"
KERNEL_DEVICETREE = " \
	adlink/${KERNEL_DEVICETREE_BASENAME}.dtb \
	adlink/${KERNEL_DEVICETREE_BASENAME}-cameras-lvds.dtb \
	adlink/${KERNEL_DEVICETREE_BASENAME}-lt9611.dtb \
	adlink/${KERNEL_DEVICETREE_BASENAME}-lt96114k.dtb \
	adlink/${KERNEL_DEVICETREE_BASENAME}-g080uan02.dtb \
	adlink/${KERNEL_DEVICETREE_BASENAME}-g156hat02.6.dtb \		
	adlink/${KERNEL_DEVICETREE_BASENAME}-ov5640.dtb \
	adlink/${KERNEL_DEVICETREE_BASENAME}-ov13855.dtb \		
	adlink/${KERNEL_DEVICETREE_BASENAME}-lt9611-pcie8997.dtb \
	adlink/${KERNEL_DEVICETREE_BASENAME}-ov13855-lvds.dtb \
	adlink/${KERNEL_DEVICETREE_BASENAME}-lt9611-noconsole.dtb \
	adlink/${KERNEL_DEVICETREE_BASENAME}-lt9611-uart2.dtb \
"

# over device tree overlay
EXTRA_OEMAKE:append:pn-linux-imx = " DTC_FLAGS='-@ -H epapr'"

# kernel patches
EXTRA_KERNEL_PATCHES = " \
	file://lec-imx95/lec-imx95_defconfig \
	file://lec-imx95/0001-Added-Adlink-ADL1001-device-driver.patch \
	file://lec-imx95/0002-Added-support-for-lt9611-bridge-and-g156hat026-g080u.patch \
	file://lec-imx95/0003-Add-mclk-support-and-modify-realtek-phy-reg.patch \
	file://lec-imx95/0004-Enabled-PCIe-compliance-mode-test.patch \
	file://lec-imx95/0005-Added-camera-support-ov13855-ov5640.patch \
"

	
	
EXTRA_KERNEL_DTS = " \
	file://lec-imx95/${KERNEL_DEVICETREE_BASENAME}.dts  \
	file://lec-imx95/${KERNEL_DEVICETREE_BASENAME}-cameras-lvds.dts \
	file://lec-imx95/${KERNEL_DEVICETREE_BASENAME}-lt9611.dts \
	file://lec-imx95/${KERNEL_DEVICETREE_BASENAME}-lt96114k.dts \
	file://lec-imx95/${KERNEL_DEVICETREE_BASENAME}-g080uan02.dts \ 
	file://lec-imx95/${KERNEL_DEVICETREE_BASENAME}-g156hat02.6.dts \  	
	file://lec-imx95/${KERNEL_DEVICETREE_BASENAME}-ov5640.dts \ 
	file://lec-imx95/${KERNEL_DEVICETREE_BASENAME}-ov13855.dts \  
	file://lec-imx95/${KERNEL_DEVICETREE_BASENAME}-lt9611-pcie8997.dtb \
	file://lec-imx95/${KERNEL_DEVICETREE_BASENAME}-ov13855-lvds.dtb \
	file://lec-imx95/${KERNEL_DEVICETREE_BASENAME}-lt9611-noconsole.dtb \
	file://lec-imx95/${KERNEL_DEVICETREE_BASENAME}-lt9611-uart2.dtb \
	file://lec-imx95/${KERNEL_DEVICETREE_BASENAME}-uart2.dtb \
	file://lec-imx95/lt9611-basic.dts \
	file://lec-imx95/lt96114k-basic.dts \
	file://lec-imx95/ov5640-basic.dts \
	file://lec-imx95/ov13855-basic.dts \		
	file://lec-imx95/g156hat02.6-basic.dts \
	file://lec-imx95/g080uan02-basic.dts \	
"

EXTRA_SRC_DTS = " \
	file://lec-imx95/imx95.dtsi \
	file://lec-imx95/imx95-pinfunc.h \
"	

KERNEL_SRC_PATCHES[lec-imx95] = " \
	${EXTRA_KERNEL_PATCHES} \
	${EXTRA_KERNEL_DTS} \
	${EXTRA_SRC_DTS} \
"

# u-boot
UBOOT_CONFIG_BASENAME = "lec-imx95"
UBOOT_DTB_NAME = "lec-imx95.dtb"
UBOOT_CONFIG = "sd"
UBOOT_CONFIG[sd] = "${UBOOT_CONFIG_BASENAME}_defconfig,sdcard"


# u-boot patches
EXTRA_UBOOT_PATCHES = " \
  file://lec-imx95/0001-Added-lec-imx95-board-support.patch \	
  file://lec-imx95/0002-LEC-i.MX95-update-uboot-to-sync-1v2.0.12.patch \	
  file://lec-imx95/lec-imx95_defconfig \
"


EXTRA_UBOOT_DTS = " \
  file://lec-imx95/lec-imx95.dts \
  file://lec-imx95/imx95.dtsi \
  file://lec-imx95/lec-imx95-u-boot.dtsi \
"
UBOOT_SRC_PATCHES[lec-imx95] = " \
	${EXTRA_UBOOT_PATCHES} \
	${EXTRA_UBOOT_DTS} \
"

IMXBOOT_TARGETS_BASENAME = "flash"
OEI_BOARD  = "mx95lp5"
DDR_TYPE   = "lpddr5"
OEI_CONFIGS = "ddr tcm dat"

DDR_FIRMWARE_NAME = " \
    lpddr5_dmem_v202311.bin \
    lpddr5_dmem_qb_v202311.bin \
    lpddr5_imem_v202311.bin \
    lpddr5_imem_qb_v202311.bin \
"

SYSTEM_MANAGER_CONFIG = "mx95lec"
M4_DEFAULT_IMAGE_MX95 = "${@bb.utils.contains('SYSTEM_MANAGER_CONFIG', 'mx95netc', 'imx95-19x19-evk_m7_TCM_netc_share.bin', \
                                                                                   'imx95-19x19-evk_m7_TCM_power_mode_switch.bin', d)}"

IMAGE_BOOT_FILES:append = " \
    imx95-19x19-evk_m7_TCM_flexcan_linux.bin \
    imx95-19x19-evk_m7_TCM_low_power_wakeword.bin \
    imx95-19x19-evk_m7_TCM_netc_share.bin \
    imx95-19x19-evk_m7_TCM_power_mode_switch.bin \
    imx95-19x19-evk_m7_TCM_rpmsg_lite_pingpong_rtos_linux_remote.bin \
    imx95-19x19-evk_m7_TCM_rpmsg_lite_str_echo_rtos.bin \
    imx95-19x19-evk_m7_TCM_sai_low_power_audio.bin \
    ${@bb.utils.contains('COMBINED_FEATURES', 'xen', 'xen', '', d)} \
"
# wic
IMAGE_FSTYPES:append = " wic wic.md5sum"


