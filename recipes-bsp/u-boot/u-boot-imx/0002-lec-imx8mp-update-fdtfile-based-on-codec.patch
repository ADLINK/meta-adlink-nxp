From a18f4d4a307f051ef17611b570e03b2892efbfbf Mon Sep 17 00:00:00 2001
From: Dinesh V <dinesh.v@adlinktech.com>
Date: Wed, 13 Dec 2023 13:13:55 +0530
Subject: [PATCH] Initial commit:Kirkstone branch:5.15.2.1.0

---
 board/adlink/lec-imx8mp/lec-imx8mp.c | 20 ++++++++++++++++++++
 1 file changed, 20 insertions(+)

diff --git a/board/adlink/lec-imx8mp/lec-imx8mp.c b/board/adlink/lec-imx8mp/lec-imx8mp.c
index 085824f34f..928e1170e3 100644
--- a/board/adlink/lec-imx8mp/lec-imx8mp.c
+++ b/board/adlink/lec-imx8mp/lec-imx8mp.c
@@ -512,6 +512,25 @@ int board_init(void)
 	return 0;
 }
 
+static void setup_codec(void)
+{
+	struct udevice *i2c_dev = NULL;
+	struct udevice *bus;
+	int ret;
+
+	ret = uclass_get_device_by_seq(UCLASS_I2C, 0x01, &bus);
+	if (ret) {
+		printf("%s: Can't find bus\n", __func__);
+		return;
+	}
+
+	ret = dm_i2c_probe(bus, 0x1A, 0, &i2c_dev); // WM8960 Audio codec
+	if (ret)
+		env_set("fdtfile", "lec-imx8mp-tlv320-lvds.dtb");
+	else
+		env_set("fdtfile", "lec-imx8mp-hydis-hv150ux2.dtb");
+}
+
 int board_late_init(void)
 {
 #ifdef CONFIG_ENV_IS_IN_MMC
@@ -521,6 +540,7 @@ int board_late_init(void)
 	env_set("board_name", "EVK");
 	env_set("board_rev", "iMX8MP");
 #endif
+	//setup_codec();
 
 	return 0;
 }
